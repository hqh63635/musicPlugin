<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>代理配置测试</title>
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
        }
        .test-section {
            margin: 20px 0;
            padding: 20px;
            border: 1px solid #ddd;
            border-radius: 5px;
        }
        button {
            padding: 10px 20px;
            background-color: #4CAF50;
            color: white;
            border: none;
            border-radius: 3px;
            cursor: pointer;
        }
        button:hover {
            background-color: #45a049;
        }
        .result {
            margin-top: 10px;
            padding: 10px;
            background-color: #f5f5f5;
            border-radius: 3px;
            white-space: pre-wrap;
        }
    </style>
</head>
<body>
    <h1>代理配置测试</h1>
    
    <div class="test-section">
        <h2>测试getLyric方法</h2>
        <button onclick="testGetLyric()">测试获取歌词</button>
        <div class="result" id="lyricResult"></div>
    </div>
    
    <div class="test-section">
        <h2>测试getMediaSource方法</h2>
        <button onclick="testGetMediaSource()">测试获取媒体资源</button>
        <div class="result" id="mediaResult"></div>
    </div>
    
    <script>
        // 测试获取歌词
        async function testGetLyric() {
            const resultDiv = document.getElementById('lyricResult');
            resultDiv.innerHTML = '测试中...';
            
            try {
                const response = await axios.get('/api/c/lyric/fcgi-bin/fcg_query_lyric_new.fcg', {
                    params: {
                        songmid: '001J1Hd00j2p35',
                        g_tk: 5381,
                        loginUin: 0,
                        hostUin: 0,
                        inCharset: 'utf8',
                        outCharset: 'utf-8',
                        notice: 0,
                        platform: 'yqq',
                        needNewCode: 0,
                        t: new Date().getTime()
                    },
                    headers: {
                        'Referer': 'https://y.qq.com/',
                        'Cookie': ''
                    }
                });
                
                resultDiv.innerHTML = `
API调用成功！
状态码: ${response.status}
响应数据: ${JSON.stringify(response.data, null, 2)}
                `;
            } catch (error) {
                resultDiv.innerHTML = `
API调用失败！
错误: ${error.message}
响应: ${error.response ? JSON.stringify(error.response.data, null, 2) : '无响应'}
                `;
            }
        }
        
        // 测试获取媒体资源
        async function testGetMediaSource() {
            const resultDiv = document.getElementById('mediaResult');
            resultDiv.innerHTML = '测试中...';
            
            try {
                const response = await axios.get('/api/u/cgi-bin/musicu.fcg', {
                    params: {
                        data: JSON.stringify({
                            'comm': {
                                'ct': 24,
                                'cv': 0
                            },
                            'url_mid': {
                                'method': 'CgiGetVkey',
                                'param': {
                                    'guid': '1234567890',
                                    'songmid': ['001J1Hd00j2p35'],
                                    'songtype': [0],
                                    'uin': '123456',
                                    'loginflag': 1,
                                    'platform': '20'
                                },
                                'module': 'vkey.GetVkeyServer'
                            }
                        })
                    },
                    headers: {
                        'Referer': 'https://y.qq.com/',
                        'Cookie': ''
                    }
                });
                
                resultDiv.innerHTML = `
API调用成功！
状态码: ${response.status}
响应数据: ${JSON.stringify(response.data, null, 2)}
                `;
            } catch (error) {
                resultDiv.innerHTML = `
API调用失败！
错误: ${error.message}
响应: ${error.response ? JSON.stringify(error.response.data, null, 2) : '无响应'}
                `;
            }
        }
    </script>
</body>
</html>
